<div class="main">
    <div class="title">
        <h3>Invoice Details</h3>
    </div>
    <!-- -----------------------------------stepper---------------------------------------------- -->
    <ul class="stepper">
        <li class="step completed">
            <span class="upper-text">{{ uploadLevel?.date }}</span>
            <span class="dot"></span>
            <span class="lower-text">
                Upload
            </span>
        </li>

        <li class="step" [ngClass]="(poLevel?.status == 'Approved' || poLevel?.status == 'Rejected') ? 'completed' : ''">
            <span class="upper-text">{{ getStatusDetails(poLevel) }}</span>
            <span class="dot"></span>
            <span class="lower-text">
                Buyer
            </span>
        </li>

        <li class="step" [ngClass]="(fhLevel?.status == 'Approved' || fhLevel?.status == 'Rejected') ? 'completed' : ''">
            <span class="upper-text">{{ getStatusDetails(fhLevel) }}</span>
            <span class="dot"></span>
            <span class="lower-text">
                Business Head
            </span>
        </li>

        <li class="step" [ngClass]="(financeLevel?.status == 'Approved' || financeLevel?.status == 'Rejected') ? 'completed' : ''">
            <span class="upper-text">{{ getStatusDetails(financeLevel) }}</span>
            <span class="dot"></span>
            <span class="lower-text">
                Finance
            </span>
        </li>

        <li class="step" [ngClass]="(getPaidStatus().length > 0) ? 'completed' : ''">
            <span class="upper-text">{{ getPaymentStatusDetails() }}</span>
            <span class="dot"></span>
            <span class="lower-text">
                Payment
            </span>
        </li>
    </ul>

    <div class="flex-container full-width details">
        <div class="description flex-item">
            <div class="flex-container">
                <div class="flex-item">
                    Vendor Id: {{ (invoiceDetails?.vendorId) ? invoiceDetails?.vendorId : "" }}
                </div>
                <div class="flex-item">
                    Vendor Name: {{ (invoiceDetails?.vendorName) ? invoiceDetails?.vendorName : "" }}
                </div>
                <div class="flex-item" *ngIf = "isPOBasedInvoice == true">
                    PO No: {{ invoiceDetails?.poNumber }}
                </div>
                <div class="flex-item">
                    Invoice No: {{ invoiceDetails?.invoiceNumber }}
                </div>
                <div class="flex-item">
                    Invoice Date: {{ getFormattedDate(invoiceDetails?.invoiceDate) }}
                </div>
                <div class="flex-item">
                    Total Inv Amt: {{ invoiceDetails?.totalAmt + " " + currency }}
                    <small> (inc tax) </small>
                </div>
                <div class="flex-item">
                    Remarks: {{ invoiceDetails?.remarks }}
                </div>
                <div class="flex-item">
                    Amount Paid: {{ getPaidAmount() }}
                </div>
                <div class="flex-item">
                    Paid Date: {{ getPaidDate() }}
                </div>
                <div class="flex-item">
                    Paid Status: {{ getPaidStatus() }}
                </div>
                <div class="flex-item actions">
                    <button mat-raised-button class="footer-actions footer-actions-green">Invoice Attachments</button>
                    <div *ngFor="let ifile of invoiceFilesList; let ifileInd = index">
                        {{ ifile.actualFileName }}
                        <button mat-button mat-icon-button aria-label="Download" (click)="downloadFile(ifile)">
                            <mat-icon>save_alt</mat-icon>
                        </button>
                    </div>
                    <button mat-raised-button class="footer-actions footer-actions-green">Supporting Attachments</button>
                    <div *ngFor="let sf of supportFilesList; let sfInd = index">
                        {{ sf.actualFileName }}
                        <button mat-button mat-icon-button aria-label="Download" (click)="downloadFile(sf)">
                            <mat-icon>save_alt</mat-icon>
                        </button>
                    </div>
                </div>
            </div>
            <div class="flex-item" style="height:100%;">
                <mat-card class="card mat-elevation-z3 full-width">
                    <table class="dataTable full-width">
                        <thead>
                            <tr>
                                <th class="headers" scope="col" *ngFor="let hdr of statusHeaderArr; let shInd = index">
                                    <span>{{ hdr }}</span>
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let apprlevel of approvalLevelList; let levelInd = index">
                                <td>
                                    <span>{{ apprlevel.levelName }}</span>
                                </td>
                                <td>
                                    <span>{{ apprlevel.status }}</span>
                                </td>
                                <td>
                                    <span>{{ apprlevel.date }}</span>
                                </td>
                                <td>
                                    <span>{{ apprlevel.remarks }}</span>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </mat-card>
            </div>
        </div>
    </div>

    <!-- table details [dataSource]="POData" -->
    <div class="container my-container margin-unset full-width">
        <table class="dataTable full-width">
            <thead>
                <tr>
                    <th class="headers" scope="col" *ngFor="let hdr of headerArr; let hInd = index">
                        <span>{{ hdr }} </span>
                    </th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let item of itemsList; let itemInd = index">
                    <td>
                        <span>{{ item.itemNumber }}</span>
                    </td>
                    <td>
                        <span>{{ item.itemDescription }}</span>
                    </td>
                    <td *ngIf = "isPOBasedInvoice == true">
                        <span>{{ item.uom }}</span>
                    </td>
                    <td>
                        <span>{{ item.hsn }}</span>
                    </td>
                    <td *ngIf = "isPOBasedInvoice == true">
                        <span>{{ item.orderedUnits }}</span>
                    </td>
                    <td *ngIf = "isPOBasedInvoice == true">
                        <span>{{ item.suppliedUnits }}</span>
                    </td>
                    <td *ngIf = "isPOBasedInvoice == true">
                        <span>{{ item.consumedUnits }}</span>
                    </td>
                    <td>
                        <span>{{ item.invoiceUnits }}</span>
                    </td>
                    <td>
                        <span>{{ currency }}</span>
                    </td>
                    <td>
                        <span>{{ item.unitPrice }}</span>
                    </td>
                    <td>
                        <span>{{ item.unitsTotalAmount }}</span>
                    </td>
                </tr>
            </tbody>
        </table>
        <div style="text-align: right">
            total Amount: {{ totalAmount + " " + currency }}
        </div>
    </div>
    <div class="row actions margin-unset">
        <button mat-raised-button class="footer-actions">Back</button>
    </div>
</div>